import{l as L}from"./core-CUqA-Dyd.js";import{C as p,A as g,d as F,f as m,a as w,D}from"./features-DViFsNSQ.js";import"./data-DcVvJSe6.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();window.logger=L;function O(o){const e=document.getElementById(o);if(e){if(o==="channelAll")p.all=e.checked,e.checked&&(Object.keys(p).forEach(t=>{t!=="all"&&(p[t]=!1)}),["channelRetail","channelWholesale","channelOnline","channelCorporate","channelCentral"].forEach(t=>{const n=document.getElementById(t);n&&(n.checked=!1)}));else{const t=o.replace("channel","").toLowerCase();if(p[t]=e.checked,Object.keys(p).filter(s=>s!=="all").some(s=>p[s])){p.all=!1;const s=document.getElementById("channelAll");s&&(s.checked=!1)}else{p.all=!0;const s=document.getElementById("channelAll");s&&(s.checked=!0)}}console.log("ğŸ¢ Kanal filtreleri gÃ¼ncellendi:",p),typeof window.loadDashboard=="function"&&window.loadDashboard()}}function z(){return p.all?g.allData:g.allData.filter(o=>{const e=F(o.store||"");return p[e]===!0})}console.log("âœ… Filters modÃ¼lÃ¼ yÃ¼klendi");const S={dashYearly:null,dashTopStores:null,dashTopSalespeople:null,dashTopBrands:null,dashTopCategories:null,dashTopCities:null,dashTopProducts:null},h={primary:"rgba(102, 126, 234, 1)",secondary:"rgba(245, 87, 108, 1)",success:"rgba(56, 239, 125, 1)",warning:"rgba(255, 206, 86, 1)",info:"rgba(79, 172, 254, 1)",purple:"rgba(153, 102, 255, 1)",orange:"rgba(255, 159, 64, 1)",pink:"rgba(255, 99, 132, 1)"},M=["Ocak","Åubat","Mart","Nisan","MayÄ±s","Haziran","Temmuz","AÄŸustos","EylÃ¼l","Ekim","KasÄ±m","AralÄ±k"];function C(o){S[o]&&(S[o].destroy(),S[o]=null)}function T(o="sales"){try{const e=document.getElementById("dashYearlyChart");if(!e)throw new Error("Chart canvas bulunamadÄ±: dashYearlyChart");if(!g.allData||g.allData.length===0)throw new Error("Veri yÃ¼klenmemiÅŸ");const t={},n={};g.allData.forEach(a=>{if(a.date){const u=a.date.substring(0,4),k=a.date.substring(5,7);t[u]||(t[u]={}),t[u][k]||(t[u][k]=0),t[u][k]+=parseFloat(a.usd_amount||0),n[u]||(n[u]={}),n[u][k]||(n[u][k]=0),n[u][k]+=parseFloat(a.quantity||0)}});const s=new Set;Object.values(t).forEach(a=>{Object.keys(a).forEach(u=>s.add(u))});const l=Array.from(s).sort(),i=o==="sales"?t:n,y=[],d=[{border:h.primary,bg:"rgba(102, 126, 234, 0.1)"},{border:h.secondary,bg:"rgba(245, 87, 108, 0.1)"},{border:h.success,bg:"rgba(56, 239, 125, 0.1)"},{border:h.warning,bg:"rgba(255, 206, 86, 0.1)"}];Object.keys(i).sort().forEach((a,u)=>{const k=i[a],v=l.map(A=>k[A]||0),I=d[u%d.length];y.push({label:`${a}`,data:v,borderColor:I.border,backgroundColor:I.bg,borderWidth:3,fill:!0,tension:.4})}),C("dashYearly");const r=l.map(a=>M[parseInt(a)-1]),c=o==="sales";S.dashYearly=new Chart(e,{type:"line",data:{labels:r,datasets:y},options:{responsive:!0,maintainAspectRatio:!0,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,position:"top"},tooltip:{callbacks:{label:function(a){return c?a.dataset.label+": "+m(a.parsed.y):a.dataset.label+": "+w(a.parsed.y)+" adet"}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:c?"SatÄ±ÅŸ (USD - KDV HariÃ§)":"Miktar (Adet)",color:c?h.primary:h.orange,font:{weight:"bold",size:12}},ticks:{callback:function(a){return c?m(a):w(a)+" adet"}}}}}})}catch(e){ErrorHandler.handleChartError("dashYearly",e)}}function b(o,e,t){const n=document.getElementById(o);if(!n)return;const s=Object.entries(e).sort((d,r)=>r[1]-d[1]).slice(0,10),l=s.map(([d])=>d),i=s.map(([,d])=>d),y=i.reduce((d,r)=>d+r,0);C(t),S[t]=new Chart(n,{type:"doughnut",data:{labels:l,datasets:[{data:i,backgroundColor:[h.primary,h.secondary,h.success,h.warning,h.info,h.purple,h.orange,h.pink,"rgba(201, 203, 207, 1)","rgba(75, 192, 192, 1)"]}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0,position:"right"},tooltip:{callbacks:{label:function(d){const r=d.parsed,c=(r/y*100).toFixed(1);return d.label+": "+m(r)+" ("+c+"%)"}}}}}})}function U(o){const e={};o.forEach(t=>{const n=t.partner||"Bilinmeyen";e[n]=(e[n]||0)+parseFloat(t.usd_amount||0)}),b("dashTopStoresChart",e,"dashTopStores")}function _(o){const e={};o.forEach(t=>{const n=t.sales_person||"Bilinmeyen";e[n]=(e[n]||0)+parseFloat(t.usd_amount||0)}),b("dashTopSalespeopleChart",e,"dashTopSalespeople")}function x(o){const e={};o.forEach(t=>{const n=t.brand||"Bilinmeyen";e[n]=(e[n]||0)+parseFloat(t.usd_amount||0)}),b("dashTopBrandsChart",e,"dashTopBrands")}function K(o){const e={};o.forEach(t=>{const n=t.category_2||t.category_1||"Bilinmeyen";["ALL","Bilinmeyen","Analitik","EÄŸitim"].includes(n)||(e[n]=(e[n]||0)+parseFloat(t.usd_amount||0))}),b("dashTopCategoriesChart",e,"dashTopCategories")}function P(o){const e={};o.forEach(t=>{const n=t.partner_city||"Bilinmeyen";e[n]=(e[n]||0)+parseFloat(t.usd_amount||0)}),b("dashTopCitiesChart",e,"dashTopCities")}function j(o){const e={};o.forEach(t=>{const n=t.product||"Bilinmeyen";e[n]=(e[n]||0)+parseFloat(t.usd_amount||0)}),b("dashTopProductsChart",e,"dashTopProducts")}console.log("âœ… Charts modÃ¼lÃ¼ yÃ¼klendi");let E="sales";function B(){if(console.log("ğŸ  Dashboard yÃ¼kleniyor..."),!g.allData||g.allData.length===0){console.warn("âš ï¸ Veri yok, dashboard yÃ¼klenemedi");return}N(),T(E),U(g.allData),_(g.allData),x(g.allData),K(g.allData),P(g.allData),j(g.allData),Y(),console.log("âœ… Dashboard yÃ¼klendi")}function N(){const o=g.allData,e=o.reduce((a,u)=>a+parseFloat(u.usd_amount||0),0),t=o.reduce((a,u)=>a+parseFloat(u.quantity||0),0),n=new Set(o.map(a=>a.partner).filter(Boolean)).size,s=new Set(o.map(a=>a.product).filter(Boolean)).size,l=new Set(o.map(a=>a.store).filter(Boolean)).size,i=new Set(o.map(a=>a.sales_person).filter(Boolean)).size,y=new Set(o.map(a=>a.date).filter(Boolean)).size,d=y>0?e/y:0,r=new Set(o.filter(a=>a.move_type==="out_invoice").map(a=>a.move_name).filter(Boolean)).size,c=r>0?e/r:0;console.log("ğŸ“Š Dashboard Ä°statistikleri:"),console.log("   ğŸ’° Toplam SatÄ±ÅŸ:",m(e)),console.log("   ğŸ“¦ Toplam ÃœrÃ¼n:",w(t)),console.log("   ğŸ‘¥ MÃ¼ÅŸteri:",n),console.log("   ğŸ¸ ÃœrÃ¼n Ã‡eÅŸidi:",s),console.log("   ğŸª MaÄŸaza:",l),console.log("   ğŸ‘¨â€ğŸ’¼ Temsilci:",i),console.log("   ğŸ“… GÃ¼nlÃ¼k Ortalama:",m(d)),console.log("   ğŸ›’ Sepet OrtalamasÄ±:",m(c)),console.log("   ğŸ§¾ Fatura SayÄ±sÄ±:",r),f("dashTotalSales",m(e)),f("dashTotalQty",w(t)),f("dashTotalCustomers",w(n)),f("dashTotalProducts",w(s)),f("dashTotalStores",w(l)),f("dashTotalSalespeople",w(i)),f("dashDailyAverage",m(d)),f("dashBasketAverage",m(c)),f("dashTotalInvoices",w(r))}function f(o,e){const t=document.getElementById(o);t&&(t.textContent=e)}function $(o){E=o;const e=document.getElementById("dashYearlyMetricSales"),t=document.getElementById("dashYearlyMetricQty");o==="sales"?(e.style.background="#667eea",e.style.color="white",t.style.background="white",t.style.color="#667eea"):(e.style.background="white",e.style.color="#667eea",t.style.background="#667eea",t.style.color="white"),T(o)}function Y(){const o=g.allData;if(!o||o.length===0){f("dashAIAnalysis","âš ï¸ Veri yok, analiz yapÄ±lamadÄ±.");return}const e=o.reduce((r,c)=>r+parseFloat(c.usd_amount||0),0),t=e/o.length,n={};o.forEach(r=>{const c=r.category_2||r.category_1||"Bilinmeyen";n[c]=(n[c]||0)+parseFloat(r.usd_amount||0)});const s=Object.entries(n).sort((r,c)=>c[1]-r[1])[0],l={};o.forEach(r=>{const c=r.store||"Bilinmeyen";l[c]=(l[c]||0)+parseFloat(r.usd_amount||0)});const i=Object.entries(l).sort((r,c)=>c[1]-r[1])[0],y=`
        <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
            <h4 style="margin: 0 0 15px 0;">ğŸ¤– AI Dashboard Analizi</h4>
            <p style="margin: 10px 0;">ğŸ“Š <strong>Toplam SatÄ±ÅŸ:</strong> ${m(e)}</p>
            <p style="margin: 10px 0;">ğŸ“ˆ <strong>Ortalama Ä°ÅŸlem:</strong> ${m(t)}</p>
            <p style="margin: 10px 0;">ğŸ† <strong>En Ä°yi Kategori:</strong> ${s?s[0]+" ("+m(s[1])+")":"Bilinmeyen"}</p>
            <p style="margin: 10px 0;">ğŸª <strong>En Ä°yi MaÄŸaza:</strong> ${i?i[0]+" ("+m(i[1])+")":"Bilinmeyen"}</p>
            <p style="margin: 10px 0;">ğŸ’¡ <strong>Ã–neri:</strong> ${s?s[0]:"Kategori"} kategorisine odaklanÄ±n ve ${i?i[0]:"maÄŸaza"} stratejisini diÄŸer maÄŸazalara uygulayÄ±n.</p>
        </div>
    `,d=document.getElementById("dashAIAnalysis");d&&(d.innerHTML=y)}window.loadDashboard=B;window.changeDashYearlyMetric=$;console.log("âœ… Dashboard modÃ¼lÃ¼ yÃ¼klendi");function q(o){console.log("ğŸ”„ switchTab Ã§aÄŸrÄ±ldÄ±:",o),document.querySelectorAll(".tab-content").forEach(l=>{l.classList.remove("active")});const t=document.querySelectorAll(".tab");t.forEach(l=>{l.classList.remove("active")});const n=document.getElementById(o+"Tab");n?(n.classList.add("active"),console.log("âœ… Tab aktif edildi:",o+"Tab")):console.error("âŒ Tab bulunamadÄ±:",o+"Tab");const s={dashboard:0,targets:1,customers:2,salesperson:3,store:4,city:5,stock:6,time:7,product:8};s[o]!==void 0&&t[s[o]].classList.add("active"),H(o)}function H(o){switch(o){case"dashboard":B();break;case"targets":typeof window.loadAllStoresTargets=="function"&&window.loadAllStoresTargets();break;case"customers":typeof window.analyzeCustomers=="function"&&window.analyzeCustomers();break;case"time":typeof window.analyzeTime=="function"&&window.analyzeTime();break;case"city":console.log("ğŸŒ Åehir analizi sekmesi aÃ§Ä±lÄ±yor..."),g.allData&&g.allData.length>0?typeof window.populateCitySelect=="function"&&window.populateCitySelect():(console.warn("âš ï¸ Veriler henÃ¼z yÃ¼klenmedi"),setTimeout(()=>{g.allData&&g.allData.length>0&&typeof window.populateCitySelect=="function"&&window.populateCitySelect()},2e3));break;case"stock":console.log("ğŸ“¦ Stok daÄŸÄ±lÄ±m sekmesi aÃ§Ä±lÄ±yor..."),console.log("ğŸ”„ Envanter verileri lazy loading ile yÃ¼kleniyor..."),typeof window.loadInventoryData=="function"&&window.loadInventoryData(),Object.keys(g.stockLocations).length===0&&(console.log("ğŸ”„ Stok konumlarÄ± yÃ¼kleniyor..."),typeof window.loadStockLocations=="function"&&window.loadStockLocations());break}}function G(o){const e={dataStatus:o.dataStatus||"",lastUpdate:o.lastUpdate||"-",totalRecords:o.totalRecords||"-",totalUSD:o.totalUSD||"-",dailyAverage:o.dailyAverage||"-",basketAverage:o.basketAverage||"-"};Object.entries(e).forEach(([t,n])=>{const s=document.getElementById(t);s&&(s.innerHTML=n)})}function R(o){if(!o||o.length===0)return;const e=[...new Set(o.map(i=>i.store).filter(Boolean))].sort(),t=[...new Set(o.map(i=>i.partner).filter(Boolean))].sort(),n=[...new Set(o.map(i=>i.sales_person).filter(Boolean))].sort(),s=[...new Set(o.map(i=>i.brand).filter(Boolean))].sort(),l=[...new Set(o.map(i=>i.category_1).filter(Boolean))].sort();console.log("ğŸ”§ Filtreler dolduruluyor:"),console.log("   ğŸª MaÄŸaza:",e.length),console.log("   ğŸ‘¥ MÃ¼ÅŸteri:",t.length),console.log("   ğŸ‘¨â€ğŸ’¼ Temsilci:",n.length),console.log("   ğŸ·ï¸ Marka:",s.length),console.log("   ğŸ“‚ Kategori:",l.length)}window.switchTab=q;window.updateSummaryCards=G;window.populateFilters=R;console.log("âœ… UI modÃ¼lÃ¼ yÃ¼klendi");class V{constructor(){this.odooUrl="https://erp.zuhalmuzik.com",this.odooDb="erp.zuhalmuzik.com",this.sessionKey="odoo_session",this.sessionDuration=7200*1e3,this.init()}init(){console.log("ğŸ” OdooAuth initialized"),this.checkSessionOnLoad()}checkSessionOnLoad(){try{console.log("ğŸ” Session kontrolÃ¼ baÅŸlatÄ±lÄ±yor..."),console.log("ğŸ” Session key:",this.sessionKey),console.log("ğŸ” Session duration:",this.sessionDuration/6e4,"dakika");const e=this.checkSession();return console.log("ğŸ” Session sonucu:",e),e.valid?(console.log("âœ… GeÃ§erli session bulundu, dashboard aÃ§Ä±lÄ±yor..."),console.log(`â° Session sÃ¼resi: ${e.remainingTime} dakika kaldÄ±`),this.updateUserInfo(e.user),this.showDashboard(),!0):(console.log("âŒ GeÃ§erli session yok, login gerekli"),console.log("âŒ Session neden geÃ§ersiz:",e),this.showLoginForm(),!1)}catch(e){return console.error("âŒ Session kontrol hatasÄ±:",e),this.showLoginForm(),!1}}updateUserInfo(e){const t=document.getElementById("currentUserName");t&&e&&(t.textContent=e.name||e.username||e.email||"KullanÄ±cÄ±",console.log("âœ… KullanÄ±cÄ± bilgisi gÃ¼ncellendi:",e.name||e.username||e.email))}showDashboard(){const e=document.getElementById("authForm"),t=document.getElementById("mainContainer");e&&(e.style.display="none"),t&&(t.style.display="block"),typeof window.loadData=="function"?(console.log("ğŸš€ loadData fonksiyonu Ã§aÄŸrÄ±lÄ±yor..."),window.loadData()):(console.log("âš ï¸ loadData fonksiyonu henÃ¼z yÃ¼klenmedi, 2 saniye bekleniyor..."),setTimeout(()=>{typeof window.loadData=="function"?(console.log("ğŸš€ loadData fonksiyonu Ã§aÄŸrÄ±lÄ±yor (gecikmeli)..."),window.loadData()):console.error("âŒ loadData fonksiyonu bulunamadÄ±!")},2e3))}showLoginForm(){const e=document.getElementById("authForm"),t=document.getElementById("mainContainer"),n=document.getElementById("userInfo");e&&(e.style.display="flex"),t&&(t.style.display="none"),n&&(n.style.display="none")}async login(e,t,n=null){try{if(!e||!t)throw new Error("KullanÄ±cÄ± adÄ± ve ÅŸifre gerekli");const s=Date.now(),l=localStorage.getItem("lastLoginAttempt"),i=parseInt(localStorage.getItem("loginAttemptCount")||"0");if(l&&s-parseInt(l)<5e3)throw new Error("Ã‡ok hÄ±zlÄ± deneme yapÄ±yorsunuz. 5 saniye bekleyin.");if(i>=3)throw new Error("Ã‡ok fazla deneme yapÄ±ldÄ±. 10 dakika bekleyin.");console.log("ğŸ” Odoo login baÅŸlatÄ±lÄ±yor..."),console.log("URL:",this.odooUrl),console.log("DB:",this.odooDb),console.log("Username:",e);const y={jsonrpc:"2.0",method:"call",params:{db:this.odooDb,login:e,password:t,totp_token:n},id:1};console.log("ğŸ“¡ Odoo'ya direkt istek atÄ±lÄ±yor...");const d=await fetch(`${this.odooUrl}/web/session/authenticate`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(y),credentials:"include"});if(!d.ok)throw console.error("âŒ Odoo HTTP hatasÄ±:",d.status),new Error(`HTTP ${d.status}: ${d.statusText}`);const r=await d.json();if(console.log("ğŸ“¡ Odoo response:",JSON.stringify(r).substring(0,200)),r.result&&r.result.uid){const c=r.result.uid,a=r.result.name||e,u=r.result.session_id;return console.log("âœ… Odoo authentication baÅŸarÄ±lÄ±!"),console.log("User ID:",c),console.log("User Name:",a),console.log("Session ID:",u),localStorage.setItem("lastLoginAttempt",s.toString()),localStorage.setItem("loginAttemptCount","0"),this.saveSession({token:u,user:{id:c,name:a,username:e,email:e},loginTime:s}),{success:!0,user:{id:c,name:a,username:e}}}else{localStorage.setItem("lastLoginAttempt",s.toString()),localStorage.setItem("loginAttemptCount",(i+1).toString());const c=r.error?.data?.message||r.error?.message||"GeÃ§ersiz kullanÄ±cÄ± adÄ±, ÅŸifre veya 2FA kodu";throw console.error("âŒ Odoo authentication baÅŸarÄ±sÄ±z:",c),new Error(c)}}catch(s){throw console.error("âŒ Odoo login hatasÄ±:",s),s}}saveSession(e){try{const t={...e,timestamp:Date.now()};console.log("ğŸ” Session kaydediliyor:",t),sessionStorage.setItem(this.sessionKey,JSON.stringify(t)),sessionStorage.setItem("userId",e.user.id),sessionStorage.setItem("userName",e.user.name),sessionStorage.setItem("userEmail",e.user.email||e.user.username),sessionStorage.setItem("authToken",e.token),console.log("âœ… Session kaydedildi:",e.user.name),console.log("âœ… Session key:",this.sessionKey),console.log("âœ… Session data:",JSON.stringify(t))}catch(t){console.error("âŒ Session kaydetme hatasÄ±:",t)}}checkSession(){try{console.log("ğŸ” Session kontrolÃ¼ yapÄ±lÄ±yor..."),console.log("ğŸ” Session key:",this.sessionKey),console.log("ğŸ” Session duration:",this.sessionDuration/6e4,"dakika");const e=sessionStorage.getItem(this.sessionKey);if(console.log("ğŸ” Session data:",e),!e)return console.log("âŒ Session data yok - sessionStorage boÅŸ"),console.log("ğŸ” TÃ¼m sessionStorage:",sessionStorage),{valid:!1};const t=JSON.parse(e);console.log("ğŸ” Parsed session:",t);const n=Date.now()-t.timestamp;if(console.log("ğŸ” Time diff:",n,"ms"),console.log("ğŸ” Session duration:",this.sessionDuration,"ms"),console.log("ğŸ” Time diff < session duration:",n<this.sessionDuration),console.log("ğŸ” Time diff dakika:",Math.round(n/6e4)),console.log("ğŸ” Session duration dakika:",Math.round(this.sessionDuration/6e4)),n<this.sessionDuration){const s=Math.round((this.sessionDuration-n)/6e4);return console.log(`âœ… GeÃ§erli session, kalan: ${s} dakika`),console.log(`â° Session sÃ¼resi: ${this.sessionDuration/6e4} dakika (120 dakika)`),{valid:!0,user:t.user,remainingTime:s}}else return console.log("â° Session sÃ¼resi dolmuÅŸ (120 dakika)"),console.log("â° Time diff:",n,"ms > Session duration:",this.sessionDuration,"ms"),console.log("â° Time diff dakika:",Math.round(n/6e4)),console.log("â° Session duration dakika:",Math.round(this.sessionDuration/6e4)),this.logout(),{valid:!1}}catch(e){return console.error("âŒ Session kontrol hatasÄ±:",e),{valid:!1}}}logout(){sessionStorage.clear(),console.log("ğŸšª Logout yapÄ±ldÄ±");const e=document.getElementById("userInfo");e&&(e.style.display="none"),window.LoginUI&&window.LoginUI.show();const t=document.getElementById("mainContainer");t&&(t.style.display="none"),console.log("ğŸ”„ Login ekranÄ±na yÃ¶nlendiriliyor...")}getToken(){return sessionStorage.getItem("authToken")}getUser(){return{id:sessionStorage.getItem("userId"),name:sessionStorage.getItem("userName"),email:sessionStorage.getItem("userEmail")}}}window.OdooAuth=new V;console.log("âœ… Odoo Auth module loaded");class J{constructor(){this.authForm=null,this.usernameInput=null,this.passwordInput=null,this.loginBtn=null,this.errorDiv=null,this.init()}init(){console.log("ğŸ¨ LoginUI initialized"),this.authForm=document.getElementById("authForm"),this.usernameInput=document.getElementById("odooUsername"),this.passwordInput=document.getElementById("odooPassword"),this.loginBtn=document.getElementById("authLoginBtn"),this.errorDiv=document.getElementById("authError")}show(){this.authForm&&(this.authForm.style.display="flex",console.log("ğŸ” Login formu gÃ¶steriliyor"),setTimeout(()=>{this.usernameInput&&this.usernameInput.focus()},100))}hide(){this.authForm&&(this.authForm.style.display="none",console.log("âœ… Login formu gizlendi"))}showLoading(){this.loginBtn&&(this.loginBtn.textContent="â³ GiriÅŸ yapÄ±lÄ±yor...",this.loginBtn.disabled=!0)}hideLoading(){this.loginBtn&&(this.loginBtn.textContent="ğŸ”“ GiriÅŸ Yap",this.loginBtn.disabled=!1)}showError(e){this.errorDiv&&(this.errorDiv.textContent=e,this.errorDiv.style.display="block",this.errorDiv.style.background="#fee",this.errorDiv.style.color="#c33"),this.hideLoading()}showSuccess(e){this.errorDiv&&(this.errorDiv.textContent=e,this.errorDiv.style.display="block",this.errorDiv.style.background="#efe",this.errorDiv.style.color="#3c3")}clearError(){this.errorDiv&&(this.errorDiv.style.display="none")}getCredentials(){return{username:this.usernameInput?.value.trim()||"",password:this.passwordInput?.value||"",totp:document.getElementById("odooTotp")?.value.trim()||""}}clearForm(){this.usernameInput&&(this.usernameInput.value=""),this.passwordInput&&(this.passwordInput.value=""),document.getElementById("odooTotp")&&(document.getElementById("odooTotp").value=""),this.clearError()}async handleLogin(){try{this.clearError(),this.showLoading();const{username:e,password:t,totp:n}=this.getCredentials();if(!e||!t){this.showError("âŒ KullanÄ±cÄ± adÄ± ve ÅŸifre gerekli");return}if(!n||n.length!==6){this.showError("âŒ 6 haneli 2FA kodu gerekli");return}const s=await window.OdooAuth.login(e,t,n);s.success&&(this.showSuccess("âœ… GiriÅŸ baÅŸarÄ±lÄ±! YÃ¶nlendiriliyorsunuz..."),this.clearForm(),setTimeout(()=>{this.hide(),window.showDashboardAfterAuth&&window.showDashboardAfterAuth(s.user)},1e3))}catch(e){console.error("âŒ Login hatasÄ±:",e),this.showError(`âŒ ${e.message||"GiriÅŸ yapÄ±lamadÄ±. LÃ¼tfen bilgilerinizi kontrol edin."}`)}}}window.LoginUI=new J;window.odooLogin=function(o,e){window.LoginUI.handleLogin()};console.log("âœ… Login UI module loaded");function Q(){const o=sessionStorage.getItem("username");if(o){const e=document.getElementById("currentUserName");e&&(e.textContent=o.charAt(0).toUpperCase()+o.slice(1))}}window.logout=function(){confirm("Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinizden emin misiniz?")&&(sessionStorage.clear(),localStorage.clear(),typeof window.showAuthForm=="function"&&window.showAuthForm(),console.log("âœ… Ã‡Ä±kÄ±ÅŸ yapÄ±ldÄ±"))};window.checkLoadingComplete=function(){if(D.ready){console.log("âœ… TÃ¼m veriler hazÄ±r!");const o=document.getElementById("loadingScreen"),e=document.getElementById("mainContainer");o&&(o.style.display="none"),e&&(e.style.display="block"),typeof window.loadDashboard=="function"&&window.loadDashboard()}};window.loadData=async function(){console.log("ğŸš€ loadData fonksiyonu Ã§aÄŸrÄ±ldÄ±");try{const o=document.getElementById("dataStatus");o&&(o.innerHTML='<span class="status-badge" style="background:#ffc107;color:#000;">â³ YÃ¼kleniyor...</span>'),loadTargets(),await loadAllData(),console.log("âœ… Veri yÃ¼kleme tamamlandÄ±"),console.log("ğŸ“Š Toplam kayÄ±t:",g.allData.length),typeof window.loadDashboard=="function"&&window.loadDashboard(),D.ready=!0,window.checkLoadingComplete()}catch(o){console.error("âŒ Veri yÃ¼kleme hatasÄ±:",o),alert("Veriler yÃ¼klenirken hata oluÅŸtu. LÃ¼tfen sayfayÄ± yenileyin.")}};window.handleChannelFilter=O;window.getFilteredData=z;window.formatCurrency=m;window.formatNumber=w;document.addEventListener("DOMContentLoaded",function(){console.log("ğŸš€ Uygulama baÅŸlatÄ±lÄ±yor..."),Q(),D.pageInit=!0,console.log("âœ… Uygulama hazÄ±r")});console.log("âœ… AppInit modÃ¼lÃ¼ yÃ¼klendi");
